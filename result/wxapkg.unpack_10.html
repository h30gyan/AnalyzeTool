<link rel="stylesheet" href="../css/bootstrap.min.css">
<script src="../js/jquery.js"></script>
<script src="../js/vue.js"></script>
<style>
    .panel {
        word-wrap: break-word;

        word-break: keep-all;

        overflow: hidden;
    }

    th {
        text-align: center;
        font-weight: normal;
        font-size: 14px;

    }

    th:hover {
        background-color: #ccdde6;
    }

    td {
        text-align: center;
        font-weight: normal;
        font-size: 14px;

    }

    a.navbar-brand {
        color: white;
    }

    a.navbar-brand:hover {
        text-decoration: none
    }

    a:link {
        color: inherit;
        text-decoration: none
    }

    .filter-label {
        height: 10px;
        font-size: small;
        margin-top: 3px;
    }

    div .view-text {
        text-align: left;
        overflow-y: auto;
    }

    .view-btn {
        text-align: right;
        font-size: medium;
        color: #d9534f;
    }

    span.view-text {
        border: 1px solid #9d9d9d;
        border-radius: 4px;
    }

    .hidden {
        display: none;
    }

    .emphasize {
        color: #d9534f;
    }

    .line {
        color: #9d9d9d;
    }

    .name-label {
        font-weight: normal;
        margin-top: 5px;
    }

    .file-name {
        font-weight: bold;
    }

    .file-path {
        color: chocolate;
        text-align: left;
    }
</style>


<div id="app">
    <div class="navbar navbar-fixed-top"
         style="position: fixed; height:60px ;z-index: 10000; width: 100%; background: rgb(8, 103, 193) none repeat scroll 0% 0%;">
        <div class="navbar-header">
            <a class="navbar-brand" href="#" style="color:white; margin-top: 4px">File Analysis Result</a>
        </div>
    </div>


    <div class="container-fluid" style="width: 95%; margin-top: 50px">
        <div class="panel panel-default" style="margin-top: 50px">
            <div class="panel-heading" style="background-color: white; border-bottom: none">


                <!--过滤标签区域-->
                <div class="col-md-4">
                    <span style="font-size: larger; margin-right: 3px; margin-left: -10px">
                    过滤关键词</span>
                    <label class="label label-info filter-label"><a
                            href="javascript:void(0)"><span class="glyphicon glyphicon-record"></span>
                        {{major_key}}</a></label>
                    <template v-for="key in include_keys">
                        <label class="label label-success filter-label" @click="del_in_key(key)"><a
                                href="javascript:void(0)" style="margin-left: 3px">
                            <span class=" glyphicon glyphicon-triangle-top"></span> {{key}}
                            &times;</a></label>&nbsp;
                    </template>
                    <template v-for="key in exclude_keys">
                        <label class="label label-danger label-lg filter-label" @click="del_ex_key(key)"><a
                                href="javascript:void(0)" style="margin-right: 3px">
                            <span class="glyphicon glyphicon-triangle-bottom"></span> {{key}}
                            &times;</a></label>&nbsp;
                    </template>
                </div>

                <!--新增过滤区域-->
                <div class="pull-right col-md-8">
                    <div class="col-md-1">
                        <label class="name-label">文件名</label>
                        <!--                        <span class="glyphicon glyphicon-play-circle"></span>-->
                    </div>
                    <div class="col-md-3">
                        <input class="pull-right form-control" v-model="target_file" />
                    </div>

                    <div class="col-md-3">
                        <input class="pull-right form-control" v-model="include_key" @keyup.enter="add_in_key"/>
                    </div>
                    <div class="col-md-1">
                        <button class="btn btn-default text-primary" style="color: #337ab7" @click="add_in_key">
                            包含
                        </button>
                    </div>
                    <div class="col-md-3">
                        <input class="pull-right form-control" v-model="exclude_key" @keyup.enter="add_ex_key"/>
                    </div>
                    <div class="col-md-1">
                        <button class="btn btn-default" style="color: #d9534f" @click="add_ex_key">不含</button>
                    </div>
                </div>

            </div>
            <div class="panel-body"></div>
            <table class="table table-responsive">
                <tr class="alert-info" style="color: black">
                    <th class="col-md-1">序号</th>
                    <th class="col-md-2">文件名</th>
                    <th class="col-md-3">文件路径</th>
                    <th class="col-md-6">预览</th>
                </tr>
                <template v-for="(file, index) in search">
                    <tr @mouseover="mouseOver(file)" @mouseleave="mouseLeave(file)" @click="fix_file(file)">
                        <td>
                            <span class="col-md-1 col-md-pull-1">
                            <span class="glyphicon glyphicon-lock text-left" v-if="file.lock"
                                  style="color: #d9534f"></span>
                            </span>
                                <span class="col-md-8 col-md-pull-2">
                            {{index+1}}
                            </span>
                        </td>
                        <td class="file-name">{{ file.name }}</td>
                        <td class="file-path">{{file.path}}</td>
                        <td class="view-text">


                            <div class="view-btn col-md-1"><a style="color: inherit; display: block"
                                                              href="javascript:void(0)" class="extend-icon">
                                <span class="glyphicon glyphicon-expand" v-if="!file.view"></span>
                                <span class="glyphicon glyphicon-collapse-down" v-else></span>
                            </a></div>


                            <div class="view-text col-md-11">
                                <!--单行内容-->
                                <span class="preview-text" v-html="switch_key(file.pre_content)"
                                      v-if="!file.view"></span>
                                <!--预览内容-->
                                <span class="view-text" style="display: block; height: 160px;"
                                      v-html="switch_key(file.content)" v-if="file.view"></span>
                            </div>
                        </td>
                    </tr>
                </template>
            </table>

        </div>
    </div>
</div>
<script>
    Vue.prototype.switch_key = function (value) {
        while (value.includes("  ")) {
            value = value.replace("  ", "&nbsp;&nbsp;")
        }
        while (value.includes("\t")) {
            value = value.replace("\t", "&nbsp;&nbsp;&nbsp;&nbsp;")
        }
        key_list = [root.major_key]
        var index = value.toLowerCase().indexOf(root.major_key)
        while(index !== -1){
            if (value.substring(index, index+root.major_key.length) !== root.major_key && !(key_list.includes(value.substring(index, index+root.major_key.length))))
                key_list.push(value.substring(index, index+root.major_key.length))
            index = value.toLowerCase().indexOf(root.major_key, index+root.major_key.length)
        }
        // alert(root.major_key);
        for (i in key_list) {
            value = value.replaceAll(key_list[i], "<span class='emphasize'>" + key_list[i] + "</span>")
        }
        return value
    }
    var root = new Vue({
        el: '#app',
        data: {
            major_key: "uploadFile",
            include_keys: [],
            exclude_keys: [],
            include_key: "",
            exclude_key: "",
            target_file: "",
            files: []
        },
        methods: {
            mouseOver: function (file) {
                file.view = true
            },
            mouseLeave: function (file) {
                if (!file.lock) {
                    file.view = false
                }
            },
            add_in_key: function () {
                if (!(this.include_keys.includes(this.include_key)) && this.include_key) {
                    this.include_keys.push(this.include_key);
                }
                this.include_key = ""
            },
            add_ex_key: function () {
                if (!(this.exclude_keys.includes(this.exclude_key)) && this.exclude_key) {
                    this.exclude_keys.push(this.exclude_key);
                }
                this.exclude_key = ""
            },
            del_in_key: function (key) {
                this.include_keys.pop(key);
            },
            del_ex_key: function (key) {
                this.exclude_keys.pop(key);
            },
            fix_file: function (file) {
                file.lock = !file.lock
            }
        },
        computed: {
            search: function () {
                var files = this.files.filter(ele => {
                    var filter = true;
                    if (this.include_keys) {
                        if (!ele.content.includes(this.include_key)) {
                            filter = false
                        }
                    }
                    if (this.exclude_key) {
                        if (ele.content.includes(this.exclude_key)) {
                            filter = false
                        }
                    }
                    if (this.target_file) {
                        if (!ele.name.includes(this.target_file)) {
                            filter = false
                        }
                    }
                    for (i in this.include_keys) {
                        if (!ele.content.includes(this.include_keys[i])) {
                            filter = false
                        }
                    }
                    for (i in this.exclude_keys) {
                        if (ele.content.includes(this.exclude_keys[i]) || ele.path.includes(this.exclude_keys[i])) {
                            filter = false
                        }
                    }
                    return filter
                })
                return files
            }
        },
    })


    root.files.push({"id": 1, "name": "12f0b3188a54e5db3c5829aafc8e2645.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\12f0b3188a54e5db3c5829aafc8e2645.js", "pre_content": "<span class='line'>2</span>      ... nectSocket:new e(\"number\",!1),uploadFile:new e(\"number\",!1), ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      new e(\"object\",!1,new e(\"array\",!1,new e(\"string\",<br><span class='line'>2</span>      !1))),networkTimeout:new e(\"object\",!1,{request:ne<br><span class='line'>2</span>      w e(\"number\",!1),connectSocket:new e(\"number\",!1),<br><span class='line'>2</span>      uploadFile:new e(\"number\",!1),downloadFile:new e(\"<br><span class='line'>2</span>      number\",!1)}),debug:new e(\"boolean\",!1),resizable:", "view": false, "lock": false},{"id": 2, "name": "256456b12e420ab246f41b4feff68e3c.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\256456b12e420ab246f41b4feff68e3c.js", "pre_content": "<span class='line'>179</span>    uploadFile: async function (t, a, s) {<br><span class='line'></span>      ", "content": "<span class='line'>176</span>                    }<br><span class='line'>177</span>                })<br><span class='line'>178</span>            },<br><span class='line'>179</span>            uploadFile: async function (t, a, s) {<br><span class='line'>180</span>                const c = a.args,<br><span class='line'>181</span>                d = l.getCurrentRuntimeConfig().setting.MaxUploadConcurrent,<br><span class='line'>182</span>                u = s();", "view": false, "lock": false},{"id": 3, "name": "256456b12e420ab246f41b4feff68e3c.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\256456b12e420ab246f41b4feff68e3c.js", "pre_content": "<span class='line'>213</span>    timeout: c.timeout || (null === (s = g.networkTimeout) || void 0 === s ? void 0 : s.uploadFile) || 6e4\t// || \u5176\u5b9e\u8d77\u5411\u540e\u9009\u62e9\u7684\u4f5c\u7528<br><span class='line'></span>      ", "content": "<span class='line'>210</span>                            headers: c.header || {},<br><span class='line'>211</span>                            formData: c.formData || {},<br><span class='line'>212</span>                            method: \"post\",<br><span class='line'>213</span>                            timeout: c.timeout || (null === (s = g.networkTimeout) || void 0 === s ? void 0 : s.uploadFile) || 6e4\t// || \u5176\u5b9e\u8d77\u5411\u540e\u9009\u62e9\u7684\u4f5c\u7528<br><span class='line'>214</span>                        };<br><span class='line'>215</span>                        i.checkURLTLSVersion() ? t.agentOptions = {<br><span class='line'>216</span>                            secureProtocol: \"TLSv1_2_method\"", "view": false, "lock": false},{"id": 4, "name": "256456b12e420ab246f41b4feff68e3c.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\256456b12e420ab246f41b4feff68e3c.js", "pre_content": "<span class='line'>267</span>    if (![\"request\", \"websocket\", \"downloadFile\", \"uploadFile\", \"udp\"].includes(o))<br><span class='line'></span>      ", "content": "<span class='line'>264</span>                    api: o,<br><span class='line'>265</span>                    url: a<br><span class='line'>266</span>                } = t.args;<br><span class='line'>267</span>                if (![\"request\", \"websocket\", \"downloadFile\", \"uploadFile\", \"udp\"].includes(o))<br><span class='line'>268</span>                    return {<br><span class='line'>269</span>                        errMsg: `${t.api}:fail api = ${o} is not allowed`<br><span class='line'>270</span>                    };", "view": false, "lock": false},{"id": 5, "name": "256456b12e420ab246f41b4feff68e3c.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\256456b12e420ab246f41b4feff68e3c.js", "pre_content": "<span class='line'>291</span>    case \"uploadFile\":<br><span class='line'></span>      ", "content": "<span class='line'>288</span>                case \"downloadFile\":<br><span class='line'>289</span>                    u = d.DownloadDomain;<br><span class='line'>290</span>                    break;<br><span class='line'>291</span>                case \"uploadFile\":<br><span class='line'>292</span>                    u = d.UploadDomain;<br><span class='line'>293</span>                    break;<br><span class='line'>294</span>                case \"udp\":", "view": false, "lock": false},{"id": 6, "name": "4463b1e9682953c14e5d10de60c1b54f.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\4463b1e9682953c14e5d10de60c1b54f.js", "pre_content": "<span class='line'>2</span>      ... connectSocket:{type:\"number\"},uploadFile:{type:\"number\"},dow ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      ionalProperties:{type:\"array\",items:{type:\"string\"<br><span class='line'>2</span>      }}},networkTimeout:{type:\"object\",properties:{requ<br><span class='line'>2</span>      est:{type:\"number\"},connectSocket:{type:\"number\"},<br><span class='line'>2</span>      uploadFile:{type:\"number\"},downloadFile:{type:\"num<br><span class='line'>2</span>      ber\"}},additionalProperties:!1},debug:{type:\"boole", "view": false, "lock": false},{"id": 7, "name": "5e1b0f28e3f236c7d45b8c0db8c37ef6.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\5e1b0f28e3f236c7d45b8c0db8c37ef6.js", "pre_content": "<span class='line'>2</span>      ... ut=Object.assign({request:6e4,uploadFile:6e4,connectSocket:6 ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      n=n.deviceOrientation||\"portrait\",a.showStatusBar=<br><span class='line'>2</span>      !!n.showStatusBar,a.loadingImageInfo=n.loadingImag<br><span class='line'>2</span>      eInfo,a.networkTimeout=Object.assign({request:6e4,<br><span class='line'>2</span>      uploadFile:6e4,connectSocket:6e4,downloadFile:6e4}<br><span class='line'>2</span>      ,n.networkTimeout),!0===n.cloud&&(a.cloud=!0);cons", "view": false, "lock": false},{"id": 8, "name": "60b3dfeabe9abb5f9b56a656020ab23b.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\60b3dfeabe9abb5f9b56a656020ab23b.js", "pre_content": "<span class='line'>2</span>      ... teUploadTask:e=&gt;g(e,\"Upload\",\"uploadFile\"),operateUploadTask ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      sk:e=&gt;u(e,\"Request\",!0),createDownloadTask:e=&gt;g(e,<br><span class='line'>2</span>      \"Download\",\"downloadFile\"),operateDownloadTask:e=&gt;<br><span class='line'>2</span>      u(e,\"Download\"),createUploadTask:e=&gt;g(e,\"Upload\",\"<br><span class='line'>2</span>      uploadFile\"),operateUploadTask:e=&gt;u(e,\"Upload\")};", "view": false, "lock": false},{"id": 9, "name": "924d9733698b3cd3205d30e729f67120.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\924d9733698b3cd3205d30e729f67120.js", "pre_content": "<span class='line'>2</span>      ... connectSocket:{type:\"number\"},uploadFile:{type:\"number\"},dow ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      ionalProperties:{type:\"array\",items:{type:\"string\"<br><span class='line'>2</span>      }}},networkTimeout:{type:\"object\",properties:{requ<br><span class='line'>2</span>      est:{type:\"number\"},connectSocket:{type:\"number\"},<br><span class='line'>2</span>      uploadFile:{type:\"number\"},downloadFile:{type:\"num<br><span class='line'>2</span>      ber\"}},additionalProperties:!1},debug:{type:\"boole", "view": false, "lock": false},{"id": 10, "name": "9ffa3218c077a28fb7ff11f06b42bafe.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\9ffa3218c077a28fb7ff11f06b42bafe.js", "pre_content": "<span class='line'>2</span>      ... ame:\"project-setting-label\"},\"uploadFile\",i.config.VALID_DOM ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      ,t.createElement(\"div\",{className:\"project-setting<br><span class='line'>2</span>      -item\",key:\"upload-domain\"},t.createElement(\"label<br><span class='line'>2</span>      \",{htmlFor:\"\",className:\"project-setting-label\"},\"<br><span class='line'>2</span>      uploadFile\",i.config.VALID_DOMAIN_NAME),t.createEl<br><span class='line'>2</span>      ement(\"div\",{className:\"project-setting-value\",sty", "view": false, "lock": false},{"id": 11, "name": "a5fa1587a86bfb25502e87d664b7d0a7.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\a5fa1587a86bfb25502e87d664b7d0a7.js", "pre_content": "<span class='line'>2</span>      ... \"getSessionLogs\",UPLOAD_FILE:\"uploadFile\",UPDATE_WECHATDEVTO ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      uchLongPress\",TOUCH_FLICK:\"touchFlick\",GET_AVAILAB<br><span class='line'>2</span>      LE_LOG_TYPES:\"getAvailableLogTypes\",GET_LOG:\"getLo<br><span class='line'>2</span>      g\",GET_SESSION_LOGS:\"getSessionLogs\",UPLOAD_FILE:\"<br><span class='line'>2</span>      uploadFile\",UPDATE_WECHATDEVTOOLS_PORT:\"updateWech<br><span class='line'>2</span>      atdevtoolsPort\",WEIXINJSBRIDGE_INVOKE:\"weixinJSBri", "view": false, "lock": false},{"id": 12, "name": "b249a570015d9ea51b9a8fb256b8a2a7.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\b249a570015d9ea51b9a8fb256b8a2a7.js", "pre_content": "<span class='line'>2</span>      ... Timeout)||void 0===n?void 0:n.uploadFile)||6e4,time:!0,rejec ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      url:u.getTargetUrl(m),headers:g.header||{},formDat<br><span class='line'>2</span>      a:g.formData||{},method:\"post\",timeout:g.timeout||<br><span class='line'>2</span>      (null===(n=r.networkTimeout)||void 0===n?void 0:n.<br><span class='line'>2</span>      uploadFile)||6e4,time:!0,rejectUnauthorized:!1,tun<br><span class='line'>2</span>      nel:!1};o.headers.Referer=`https://servicewechat.c", "view": false, "lock": false},{"id": 13, "name": "b80fb9c7462ab7928b8c861570833e66.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\b80fb9c7462ab7928b8c861570833e66.js", "pre_content": "<span class='line'>2</span>      ... rewriteRoute:k,downloadFile:h,uploadFile:h,createUploadTask: ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      teTo:k,navigateBack:k,redirectTo:k,switchTab:k,reL<br><span class='line'>2</span>      aunch:k,updateApp:k,openUrl:k,restart:k,setNavigat<br><span class='line'>2</span>      eBackInterception:k,rewriteRoute:k,downloadFile:h,<br><span class='line'>2</span>      uploadFile:h,createUploadTask:h,operateUploadTask:<br><span class='line'>2</span>      h,createDownloadTask:h,operateDownloadTask:h,check", "view": false, "lock": false},{"id": 14, "name": "f0b18e55367e3c6af5b39a7b81777293.js", "path": "F:\\\u5b66\u4e60\u7b14\u8bb0\\\u5fae\u4fe1\u9006\u5411\u5b66\u4e60\\core\\wxapkg.unpack\\f0b18e55367e3c6af5b39a7b81777293.js", "pre_content": "<span class='line'>2</span>      ... ut:Object.assign({request:6e4,uploadFile:6e4,connectSocket:6 ...<br><span class='line'></span>      ", "content": "<span class='line'>2</span>      d,global:{window:Object.assign(Object.assign({},r.<br><span class='line'>2</span>      getDefaultWindowConfig(e.darkmode&&i)),e.window)},<br><span class='line'>2</span>      page:{},networkTimeout:Object.assign({request:6e4,<br><span class='line'>2</span>      uploadFile:6e4,connectSocket:6e4,downloadFile:6e4}<br><span class='line'>2</span>      ,e.networkTimeout),ext:e.ext||{},extAppid:e.extApp", "view": false, "lock": false})
</script>